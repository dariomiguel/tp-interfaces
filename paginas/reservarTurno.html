<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Campaña de Vacunación Provincial</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../estilos/indice.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
</head>

<body>
    <header class="py-3">
        <div class="d-flex justify-content-around align-items-center">
            <h4 class="m-0 fw-bold">VACUNATE PROVINCIA</h4>
            <nav class="d-flex align-items-center">
                <a href="../paginas/indexSesionIniciada.html" class="text-white text-decoration-none me-3">Inicio</a>
                <a href="../paginas/indexSesionIniciada.html"
                    class="text-white text-decoration-none d-flex align-items-center">
                    <i class="bi bi-person-circle fs-4 me-2"></i>
                    <span class="d-none d-sm-inline">Mario Luis</span>
                </a>
            </nav>
        </div>
    </header>


    <main class="content d-flex justify-content-center align-items-center " style="min-height: 60vh;">
        <section class="hero w-100 reservar-turno">
            <div class="container d-flex flex-column align-items-center py-4 borde-sombreado ">
                <h2 class="text-center mb-2 fw-bold fs-1 d-flex flex-column">Reservá tu turno de vacunación:</br> <span
                        class="back-informativo"
                        style="color:white;border-radius: 1rem; padding:0.5%;align-self: center;">Mario Luis</span></h2>
                <form class="d-flex flex-column gap-5 mt-5">

                    <div class="mb-3 item-reservar-turno">
                        <label class="form-label d-block mb-2 fs-3 fw-bold">Tipo de vacuna</label>
                        <!-- visibles siempre -->
                        <div class="btn-group d-flex flex-wrap gap-3 mb-2" role="group" aria-label="Vacunas visibles">
                            <!-- covid -->
                            <input type="radio" class="btn-check" name="tipoVacuna" id="covid" autocomplete="off">
                            <label class="btn btn-outline-color1 rounded-pill flex-fill d-flex align-items-center py-2"
                                for="covid">
                                <img src="../img/jeringa.png" alt="COVID" class="me-2 jeringa">
                                <span>COVID-19</span>
                            </label>
                            <!-- gripe -->
                            <input type="radio" class="btn-check" name="tipoVacuna" id="gripe" autocomplete="off">
                            <label class="btn btn-outline-color2 rounded-pill flex-fill d-flex align-items-center py-2"
                                for="gripe">
                                <img src="../img/jeringa.png" alt="Gripe" class="me-2 jeringa">
                                <span>Gripe</span>
                            </label>
                            <!-- fiebre amarilla -->
                            <input type="radio" class="btn-check" name="tipoVacuna" id="fiebreAmarilla"
                                autocomplete="off">
                            <label class="btn btn-outline-color3 rounded-pill flex-fill d-flex align-items-center py-2"
                                for="fiebreAmarilla">
                                <img src="../img/jeringa.png" alt="Fiebre amarilla" class="me-2 jeringa">
                                <span>Fiebre amarilla</span>
                            </label>
                        </div>

                        <!-- oculto por defecto -->
                        <div id="vacunasExtra" class="collapse">
                            <div class="btn-group d-flex flex-wrap gap-3" role="group" aria-label="Vacunas ocultas">
                                <!-- hepatitis b -->
                                <input type="radio" class="btn-check" name="tipoVacuna" id="hepB" autocomplete="off">
                                <label
                                    class="btn btn-outline-color4 rounded-pill flex-fill d-flex align-items-center py-2"
                                    for="hepB">
                                    <img src="../img/jeringa.png" alt="Hepatitis B" class="me-2 jeringa">
                                    <span>HEP</span>
                                </label>
                                <!-- neumococo -->
                                <input type="radio" class="btn-check" name="tipoVacuna" id="neumococo"
                                    autocomplete="off">
                                <label
                                    class="btn btn-outline-color5 rounded-pill flex-fill d-flex align-items-center py-2"
                                    for="neumococo">
                                    <img src="../img/jeringa.png" alt="Neumococo" class="me-2 jeringa">
                                    <span>NEU</span>
                                </label>
                                <!-- triple bacteriana acelular -->
                                <input type="radio" class="btn-check" name="tipoVacuna" id="tba" autocomplete="off">
                                <label
                                    class="btn btn-outline-color3 rounded-pill flex-fill d-flex align-items-center py-2"
                                    for="tba">
                                    <img src="../img/jeringa.png" alt="Jeringa Triple Bacteriana Acelular"
                                        class="me-2 jeringa">
                                    <span>TBA</span>
                                </label>
                                <!-- doble bacteriana -->
                                <input type="radio" class="btn-check" name="tipoVacuna" id="db" autocomplete="off">
                                <label
                                    class="btn btn-outline-color1 rounded-pill flex-fill d-flex align-items-center py-2"
                                    for="db">
                                    <img src="../img/jeringa.png" alt="Jeringa Doble Bacteriana" class="me-3 jeringa">
                                    <span title="Doble Bacteriana">DBA</span>
                                </label>
                                <!-- doble viral -->
                                <input type="radio" class="btn-check" name="tipoVacuna" id="dv" autocomplete="off">
                                <label
                                    class="btn btn-outline-color4 rounded-pill flex-fill d-flex align-items-center py-2"
                                    for="dv">
                                    <img src="../img/jeringa.png" alt="Jeringa Doble Viral" class="me-3 jeringa">
                                    <span title="Doble Viral">DVI</span>
                                </label>
                                <!-- virus sincicial respiratorio -->
                                <input type="radio" class="btn-check" name="tipoVacuna" id="vsr" autocomplete="off">
                                <label
                                    class="btn btn-outline-color2 rounded-pill flex-fill d-flex align-items-center py-2"
                                    for="vsr">
                                    <img src="../img/jeringa.png" alt="Jeringa Virus Sincicial Respiratorio"
                                        class="me-3 jeringa">
                                    <span title="Virus Sincicial Respiratorio">VSR</span>
                                </label>
                                <!-- fiebre hemorrágica argentina -->
                                <input type="radio" class="btn-check" name="tipoVacuna" id="fha" autocomplete="off">
                                <label
                                    class="btn btn-outline-color5 rounded-pill flex-fill d-flex align-items-center py-2"
                                    for="fha">
                                    <img src="../img/jeringa.png" alt="Jeringa Fiebre Hemorrágica Argentina"
                                        class="me-3 jeringa">
                                    <span title="Fiebre Hemorrágica Argentina">FHA</span>
                                </label>
                            </div>
                        </div>

                        <!-- botón para expandir -->
                        <div class="mt-3">
                            <button class="btn btn-custom rounded-pill" type="button" data-bs-toggle="collapse"
                                data-bs-target="#vacunasExtra" aria-expanded="false" aria-controls="vacunasExtra"
                                id="toggleVacunasBtn">
                                Ver más
                            </button>
                        </div>
                    </div>
                    <div class="mb-3 item-reservar-turno">
                        <label class="form-label d-block mb-2 fs-3 fw-bold">Centro de vacunación</label>
                        <p>Tus centros de salud más cercanos:</p>
                        <div class="d-flex flex-wrap justify-content-center gap-2 mb-3" role="group"
                            aria-label="Centro de vacunación">
                            <input type="radio" class="btn-check " name="centroVacunacion" id="sanJusto"
                                autocomplete="off">
                            <label
                                class="btn btn-outline-color4 m-1 flex-fill text-center borde-negro fit-content select-vacunacion"
                                for="sanJusto">Ctro Vacunación San Justo</label>
                            <input type="radio" class="btn-check " name="centroVacunacion" id="laTablada"
                                autocomplete="off">
                            <label
                                class="btn btn-outline-color4 m-1 flex-fill text-center borde-negro fit-content select-vacunacion"
                                for="laTablada">Ctro Vacunación La Tablada</label>
                            <input type="radio" class="btn-check" name="centroVacunacion" id="ramosMejia"
                                autocomplete="off">
                            <label
                                class="btn btn-outline-color4 m-1 flex-fill text-center borde-negro fit-content select-vacunacion"
                                for="ramosMejia">Ctro Vacunación Ramos Mejía</label>
                        </div>

                        <!-- buscador -->
                        <p>¿No te sirven esos? Buscá otros centros disponibles:</p>
                        <input type="text" id="buscadorCentros" class="form-control rounded-pill mb-3"
                            placeholder="Buscar por localidad o nombre...">

                        <!-- resultados filtrables -->
                        <div id="otrosCentros" class="btn-group d-flex flex-wrap" role="group"
                            aria-label="Otros centros">
                            <input type="radio" class="btn-check" name="centroVacunacion" id="ituzaingo"
                                autocomplete="off">
                            <label
                                class="btn btn-outline-color4 m-1 flex-fill text-center borde-negro fit-content select-vacunacion"
                                for="ituzaingo">
                                Ctro Vacunación Ituzaingó
                            </label>

                            <input type="radio" class="btn-check" name="centroVacunacion" id="moron" autocomplete="off">
                            <label
                                class="btn btn-outline-color4 m-1 flex-fill text-center borde-negro fit-content select-vacunacion"
                                for="moron">
                                Ctro Vacunación Morón
                            </label>

                            <input type="radio" class="btn-check" name="centroVacunacion" id="merlo" autocomplete="off">
                            <label
                                class="btn btn-outline-color4 m-1 flex-fill text-center borde-negro fit-content select-vacunacion"
                                for="merlo">
                                Ctro Vacunación Merlo
                            </label>
                        </div>
                    </div>

                    <div class="row align-items-stretch item-reservar-turno">
                        <!-- Mes y Semana -->
                        <div class="col-md-6 mb-3">
                            <label for="mes" class="form-label fs-3 fw-bold">Mes</label>
                            <p style="margin-top: 0rem;">Desde hoy hasta 3 meses en adelante</p>
                            <select class="form-select border border-dark rounded-pill cursor-pointer" id="mes">
                                <option selected disabled>Seleccioná un mes</option>
                                <!-- Opciones cargadas por JS -->
                            </select>

                            <div class="mt-4">
                                <label for="semana" class="form-label fs-3 fw-bold">Semana</label>
                                <select class="form-select border border-dark rounded-pill cursor-pointer" id="semana">
                                    <option selected disabled>Seleccioná una semana</option>
                                </select>
                            </div>
                        </div>

                        <!-- Franja horaria -->
                        <div class="col-md-6 mb-3">
                            <label class="form-label d-block mb-3 fs-3 fw-bold">Franja horaria</label>
                            <div class="d-flex flex-column align-items-center gap-2" role="group"
                                aria-label="Franja horaria">

                                <input type="radio" class="btn-check" name="franjaHoraria" id="manana"
                                    autocomplete="off">
                                <label class="btn btn-outline-color5 rounded-pill text-center fit-content px-3 py-2"
                                    for="manana">Mañana (09:00 - 11:00)</label>

                                <input type="radio" class="btn-check" name="franjaHoraria" id="mediodia"
                                    autocomplete="off">
                                <label class="btn btn-outline-color5 rounded-pill text-center fit-content px-3 py-2"
                                    for="mediodia">Mediodía (11:00 - 14:00)</label>

                                <input type="radio" class="btn-check" name="franjaHoraria" id="tarde"
                                    autocomplete="off">
                                <label class="btn btn-outline-color5 rounded-pill text-center fit-content px-3 py-2"
                                    for="tarde">Tarde (14:00 - 18:00)</label>

                                <input type="radio" class="btn-check" name="franjaHoraria" id="tardeNoche"
                                    autocomplete="off">
                                <label class="btn btn-outline-color5 rounded-pill text-center fit-content px-3 py-2"
                                    for="tardeNoche">Tarde-noche (18:00 - 20:00)</label>
                            </div>
                        </div>
                    </div>
                    <a href="../paginas/confirmarTurno.html" class="btn btn-custom w-100 mt-3">Confirmar turno </a>
                </form>
            </div>
    </main>


    <footer>
        <div class="container">
            <p class="mb-0">© 2025 Gobierno de la Provincia. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
   <script>
  const mesSelect = document.getElementById("mes");
  const semanaSelect = document.getElementById("semana");

  const today = new Date();
  const maxDate = new Date();
  maxDate.setMonth(today.getMonth() + 3);
  const semanasPorMes = {};
  const restriccionesPorSemana = {}; // Nueva estructura para guardar estados

  let current = new Date(today);

  while (current <= maxDate) {
    const startOfWeek = new Date(current);
    startOfWeek.setDate(current.getDate() - current.getDay() + 1);
    const endOfWeek = new Date(startOfWeek);
    endOfWeek.setDate(startOfWeek.getDate() + 6);

    const monthLabel = startOfWeek.toLocaleString("es-ES", {
      month: "long",
      year: "numeric",
    });
    const weekLabel = `${startOfWeek.getDate()}–${endOfWeek.getDate()} de ${monthLabel}`;
    const isoDate = startOfWeek.toISOString().split("T")[0];

    if (!semanasPorMes[monthLabel]) semanasPorMes[monthLabel] = [];
    semanasPorMes[monthLabel].push({ text: weekLabel, value: isoDate });

    current.setDate(current.getDate() + 7);
  }

  Object.keys(semanasPorMes).forEach((mes) => {
    const option = document.createElement("option");
    option.value = mes;
    option.textContent = mes.charAt(0).toUpperCase() + mes.slice(1);
    mesSelect.appendChild(option);
  });

  mesSelect.addEventListener("change", function () {
    const elegido = this.value;
    semanaSelect.innerHTML = `<option selected disabled>Seleccioná una semana</option>`;
    semanasPorMes[elegido].forEach((semana) => {
      const option = document.createElement("option");
      option.value = semana.value;
      option.textContent = semana.text;
      semanaSelect.appendChild(option);
    });
  });

  function pintarSiSeleccionado(selectElement) {
    const seleccionado = selectElement.value;
    if (seleccionado) {
      selectElement.style.backgroundColor = "#0B6F53";
      selectElement.style.fontWeight = "bold";
      selectElement.style.color = "white";
    }
  }

  domMesSelect = document.getElementById("mes");
  domSemanaSelect = document.getElementById("semana");

  domMesSelect.addEventListener("change", function () {
    pintarSiSeleccionado(domMesSelect);
  });

  domSemanaSelect.addEventListener("change", function () {
    pintarSiSeleccionado(domSemanaSelect);
  });

  const nodoSemana = document.getElementById("semana");
  const franjaIds = ["manana", "mediodia", "tarde", "tardeNoche"];
  const franjaInputs = franjaIds.map((id) => document.getElementById(id));

  nodoSemana.addEventListener("change", function () {
    const semanaElegida = this.value;

    // 1. Habilitar todas las franjas
    franjaInputs.forEach((input) => {
      input.disabled = false;
      input.nextElementSibling.classList.remove("disabled-label");
    });

    let seleccionadas;

    // 2. Si ya se eligieron restricciones para esta semana, usarlas
    if (restriccionesPorSemana[semanaElegida]) {
      seleccionadas = restriccionesPorSemana[semanaElegida];
    } else {
      // 3. Si no, generar aleatoriamente entre 1 y 3 franjas
      const cantidad = Math.floor(Math.random() * 3) + 1;
      seleccionadas = [];

      while (seleccionadas.length < cantidad) {
        const index = Math.floor(Math.random() * franjaInputs.length);
        const id = franjaIds[index];
        if (!seleccionadas.includes(id)) {
          seleccionadas.push(id);
        }
      }

      // Guardamos para que esa semana mantenga su lógica
      restriccionesPorSemana[semanaElegida] = seleccionadas;
    }

    // 4. Aplicar restricciones
    seleccionadas.forEach((id) => {
      const input = document.getElementById(id);
      input.disabled = true;
      input.nextElementSibling.classList.add("disabled-label");
    });
  });
</script>

    <script>
        const buscador = document.getElementById("buscadorCentros");
        const otrosCentros = document.getElementById("otrosCentros");
        const etiquetas = otrosCentros.querySelectorAll("label");

        buscador.addEventListener("input", () => {
            const texto = buscador.value.toLowerCase().trim();

            etiquetas.forEach(label => {
                const contenido = label.textContent.toLowerCase();
                if (texto === "") {
                    label.style.display = "none"; // oculta si no se está buscando
                } else {
                    label.style.display = contenido.includes(texto) ? "inline-flex" : "none";
                }
            });
        });

        // Al principio ocultamos los centros extra
        window.addEventListener("DOMContentLoaded", () => {
            etiquetas.forEach(label => label.style.display = "none");
        });
    </script>
</body>

</html>